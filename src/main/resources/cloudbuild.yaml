steps:
  # Build the Docker image
  - name: 'gcr.io/cloud-builders/mvn'
    args: ['package']

  # Push the Docker image to Google Container Registry
  - name: 'gcr.io/cloud-builders/docker'
    args: ['build', 't', 'gcr.io/${_PROJECT_ID}/${_IMAGE_NAME}:${_SHORT_SHA}','.']

images:
  - 'gcr.io/${_PROJECT_ID}/${_IMAGE_NAME}:${_SHORT_SHA}'

options:
  logging: LEGACY
  logStreamingOption: STREAM_ON
  defaultLogsBucketBehavior: REGIONAL_USER_OWNED_BUCKET

substitutions:
  _PROJECT_ID: burner-tanazad1
  _REGION: us-central1
  _IMAGE_NAME: sample-gke
  _REPO_NAME: dev-spring-boot-gke-repo-01
  _SERVICE_NAME: sample-gke
  _VERSION: v1.0
  _AUTH: --allow-unauthenticated
  _VPC_CONN: dev-spring-boot-gke-repo-01
  _TRAFFIC: all-traffic
  _TIME_O: timeout=3600
  _MEMORY: 1024Mi